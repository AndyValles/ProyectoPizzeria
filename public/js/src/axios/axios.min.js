import { base_url, close_modal, query, queryAll } from "../../load.min.js";
import { getData, loadData } from "../manipulador.min.js";

export function Create(data) {
    axios({
        method: "post",
        url: base_url + "/create",
        data: data,
        responseType: "json"
    }).then(function(resultado) {
        window.location.href = base_url;
        getData(1);
    });
}

export function Edit(id, data) {
    axios({
        method: "put",
        url: base_url + "/" + id + '/update',
        data: data,
        responseType: "json"
    }).then(function(resultado) {
        window.location.href = base_url;
        getData(1);
    });
}

export function Delete(id, data) {
    axios({
        method: "delete",
        url: base_url + "/" + id + '/delete',
        data: data,
        responseType: "json"
    }).then(function(resultado) {
        close_modal();
        getData(1);
    });
}

export function Buscar(data) {
    axios({
        method: "post",
        url: base_url + '/loadData',
        data: data,
        responseType: "json"
    }).then(function(resultado) {
        loadData(resultado.data.values, 1)
    });
}

export function ObtenerEstado(id) {
    var estado = "0";
    queryAll(id).forEach(element => {
        var check = element.checked;
        if (check == true) {
            var obtenerItem = element.getAttribute("data-value");
            estado = obtenerItem == "SI" ? "1" : "0";
        }
    });
    return estado;
}

export function obtenerHora() {
    var principal = query(".ctn-time-input").innerHTML;
    var childs = query(".ctn-time-input").childNodes;
    var hora = "";
    for (const hijo of childs) {
        var name = hijo.nodeName.toLowerCase();
        var a = "";
        if (name == "span") {
            a = hijo.innerHTML;
        } else if (name == "select") {
            a = hijo.value;
        } else if (name == "input") {
            a = hijo.value;
        }
        hora += a + " ";
    }
    return hora;
}