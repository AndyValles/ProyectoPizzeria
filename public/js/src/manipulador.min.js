'use strict';
import { query, queryAll, get, classResplace, base_url } from "../load.min.js";


const entidad = query("#entidad") != null ? query("#entidad").getAttribute("content") : null;
var numberPaginate = 1;
var info;

export function Filter_Radio(id) {
    queryAll(".icon-rd").forEach(key => { key.classList.replace("icon-radio-checked", "icon-radio-unchecked") });
    queryAll(".input-search-filter").forEach(key => { key.type = "hidden" });

    classResplace("#icon-RB-" + id, "icon-radio-unchecked", "icon-radio-checked")

    query("#id_bus").innerHTML = id;
    query(".dp-flex").classList.remove("dp-flex");
    query("#Bus_LUG_" + id).type = "text";
}

export function Filter_CBK(id) {
    if (query("#icon-CBK-" + id).classList.contains("icon-checkbox-checked")) {
        query("#icon-CBK-" + id).classList.replace("icon-checkbox-checked", "icon-checkbox-unchecked");
    } else {
        classResplace("#icon-CBK-" + id, "icon-checkbox-unchecked", "icon-checkbox-checked")
    }
    queryAll(".tb_" + id).forEach(key => { key.classList.toggle("dp-none") });
}

export function cargar_modal_filter(url) {
    query(".modal").classList.add("dp-flex");
    axios.get(url).
    then(res => {
        query(".modal").innerHTML = res.data;
    }).catch(err => {
        console.error(err);
    });
}

export function loadData(value, id) {
    info = value;
    getData(id);
}

export function getData(id) {
    numberPaginate = id;
    let data = {
        values: info,
        limit: query("#PaginateId").value,
        offset: numberPaginate
    };

    axios({
        method: "post",
        url: base_url + "/search/",
        data: data,
        responseType: "json"
    }).
    then(res => {
        query(".paginate_" + entidad).innerHTML = res.data.paginate;
        query(".table-" + entidad).innerHTML = res.data.table;
        query(".id_ver").innerHTML = res.data.Ver;
    }).catch(err => {
        console.error(err);
    });
}

export function edit_open(id) {
    query("#Edit_" + id).classList.toggle("h-90");
}

export const tabCargar = (url, el) => {
    queryAll('.btn-crud-tabs').forEach(event => {
        event.classList.remove("btn-select-tabs");
        if (el == event.innerHTML) {
            if (el == "Tabla") {
                window.location.href = base_url;
            }
            event.classList.add("btn-select-tabs");
            query(".row-crud-table").innerHTML = "";
            get(url, ".row-crud-table");
        }
    });
}

export const value_lista = (info) => {
    var actual = info.getAttribute("data-value");
    var name = info.value;
    if (name.length > 0) {
        query(".listar-" + actual).classList.add("dp-block");
    } else {
        query(".listar-" + actual).classList.remove("dp-block");
    }
}
